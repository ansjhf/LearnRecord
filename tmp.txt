import com.alibaba.excel.ExcelReader;
import com.alibaba.excel.EasyExcelFactory;
import com.alibaba.excel.read.metadata.ReadSheet;
import com.alibaba.excel.read.metadata.ReadWorkbook;
import com.alibaba.excel.context.AnalysisContext;
import com.alibaba.excel.event.AnalysisEventListener;

import java.io.FileInputStream;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;

public class ExcelReaderRaw {

    public static List<List<String>> readRawExcel(String filePath) {
        List<List<String>> dataList = new ArrayList<>();

        try (InputStream inputStream = new FileInputStream(filePath)) {

            ExcelReader excelReader = EasyExcelFactory.read(inputStream, new AnalysisEventListener<List<Object>>() {
                @Override
                public void invoke(List<Object> data, AnalysisContext context) {
                    List<String> row = new ArrayList<>();
                    for (Object cell : data) {
                        row.add(cell == null ? "" : cell.toString());
                    }
                    dataList.add(row);
                }

                @Override
                public void doAfterAllAnalysed(AnalysisContext context) {
                    // 完成
                }
            }).headRowNumber(0).build();

            ReadSheet readSheet = EasyExcelFactory.readSheet(0).build();
            excelReader.read(readSheet);
            excelReader.finish();

        } catch (Exception e) {
            e.printStackTrace();
        }

        return dataList;
    }

    public static void main(String[] args) {
        String filePath = "test.xlsx";
        List<List<String>> result = readRawExcel(filePath);
        System.out.println("总行数：" + result.size());
        for (List<String> row : result) {
            System.out.println(row);
        }
    }
}