private static class SheetHandler extends DefaultHandler {
    // ... 其他变量和构造方法保持不变 ...

    @Override
    public void startElement(String uri, String localName, String name, Attributes attributes) throws SAXException {
        if (name.equals("row")) {
            isRowTag = true;
        }
        if (isRowTag && isFirstRow && name.equals("c")) { // c for cell
            String cellType = attributes.getValue("t"); // t for type
            String cellValue = "";
            if ("s".equals(cellType)) { // s means string
                int idx = Integer.parseInt(attributes.getValue("r").replaceAll("[^0-9]", "")) - 1; // 获取列索引
                String val = attributes.getValue("v");
                if (val != null) {
                    // 使用 XSSFRichTextString 来获取共享字符串
                    XSSFRichTextString richTextString = new XSSFRichTextString(sharedStringsTable.getEntryAt(Integer.parseInt(val)).getText());
                    cellValue = richTextString != null ? richTextString.toString() : "";
                }
            } else {
                String inputValue = attributes.getValue("v");
                cellValue = inputValue != null ? formatter.formatRawCellContents(Double.parseDouble(inputValue), 0, null) : "";
            }
            firstRow.add(cellValue.isEmpty() ? "" : cellValue);
        }
    }

    // ... 其他方法保持不变 ...
}